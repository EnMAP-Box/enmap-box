from enmapbox.typeguard import typechecked
from enmapboxprocessing.algorithm.spectralresamplingbyresponsefunctionconvolutionalgorithmbase import \
    SpectralResamplingByResponseFunctionConvolutionAlgorithmBase


@typechecked
class SpectralResamplingToEnmapAlgorithm(SpectralResamplingByResponseFunctionConvolutionAlgorithmBase):
    A_CODE = True

    def displayName(self) -> str:
        return 'Spectral resampling (to EnMAP)'

    def shortDescription(self) -> str:
        link = self.htmlLink('https://www.enmap.org/', 'EnMAP')
        return super().shortDescription() + f'\nFor more information see the {link} mission website.'

    def code(self):
        from collections import OrderedDict

        responses = OrderedDict()

        fwhm = {6.99561, 6.6675, 6.42408, 6.25124, 6.13485, 6.06076, 6.01486, 5.98302, 5.95232, 5.9199, 5.88775, 5.8579,
                5.83239, 5.81325, 5.8025, 5.8022, 5.81407, 5.83751, 5.87076, 5.91208, 5.95969, 6.01183, 6.06674,
                6.12279, 6.1794, 6.23648, 6.29397, 6.35179, 6.40987, 6.46815, 6.52654, 6.58497, 6.64338, 6.70177,
                6.76072, 6.82113, 6.88388, 6.94987, 7.01999, 7.09511, 7.17533, 7.25495, 7.33145, 7.40537, 7.47729,
                7.54777, 7.61738, 7.68669, 7.75628, 7.8267, 7.89853, 7.97235, 8.04871, 8.1281, 8.2102, 8.29433, 8.3798,
                8.46592, 8.552, 8.63735, 8.72128, 8.80311, 8.88214, 8.95779, 9.03034, 9.1005, 9.16897, 9.23646, 9.30368,
                9.37133, 9.44012, 9.51076, 9.58396, 9.66032, 9.73971, 9.82161, 9.90551, 9.99089, 10.0772, 9.17725,
                9.31901, 9.45441, 9.58399, 9.7083, 9.82789, 9.94331, 10.0551, 10.1638, 10.27, 10.3742, 10.4768, 10.5775,
                10.6753, 10.769, 10.8578, 10.9405, 11.0162, 11.0839, 11.1437, 11.196, 11.2414, 11.2806, 11.3139,
                11.3421, 11.3656, 11.385, 11.4009, 11.4135, 11.4229, 11.4292, 11.4325, 11.4329, 11.4305, 11.4253,
                11.4176, 11.4073, 11.3946, 11.3796, 11.3624, 11.343, 11.3215, 11.2981, 11.2728, 11.0876, 11.052,
                11.0151, 10.9772, 10.9383, 10.8984, 10.8577, 10.8161, 10.7738, 10.7308, 10.6872, 10.643, 10.5985,
                10.5535, 10.5082, 10.4626, 10.4169, 10.371, 10.3251, 10.2793, 10.2335, 10.1879, 10.1425, 10.0974,
                10.0525, 10.0079, 9.96359, 9.91949, 9.16572, 9.12592, 9.08633, 9.04694, 9.00775, 8.96875, 8.92995,
                8.89134, 8.85292, 8.81469, 8.77665, 8.73878, 8.70111, 8.66361, 8.62632, 8.58923, 8.55236, 8.51572,
                8.47932, 8.44317, 8.40728, 8.37166, 8.33632, 8.30128, 8.26653, 8.2321, 8.198, 8.16422, 8.13079, 8.09771,
                8.065, 8.03267, 8.00072, 7.96916, 7.93802, 7.90728, 7.87694, 7.84695, 7.81727, 7.78785, 7.75866,
                7.72966, 7.70079, 7.67203, 7.64333, 7.61464, 7.58593, 7.55715, 7.52827, 7.49924, 7.47001, 7.44055,
                7.41082, 7.38077, 7.35037, 7.31957, 7.28832, 7.25659, 7.22434, 7.19152, 7.1581}

        wavelength = {418.24, 423.874, 429.294, 434.528, 439.603, 444.549, 449.391, 454.159, 458.884, 463.584, 468.265,
                      472.934, 477.599, 482.265, 486.941, 491.633, 496.349, 501.094, 505.87, 510.678, 515.519, 520.397,
                      525.313, 530.268, 535.265, 540.305, 545.391, 550.525, 555.71, 560.947, 566.239, 571.587, 576.995,
                      582.464, 587.997, 593.596, 599.267, 605.011, 610.833, 616.737, 622.732, 628.797, 634.919, 641.1,
                      647.341, 653.643, 660.007, 666.435, 672.927, 679.485, 686.11, 692.804, 699.567, 706.401, 713.307,
                      720.282, 727.324, 734.431, 741.601, 748.833, 756.124, 763.472, 770.876, 778.333, 785.843, 793.402,
                      801.01, 808.665, 816.367, 824.112, 831.901, 839.731, 847.601, 855.509, 863.455, 871.433, 879.442,
                      887.478, 895.537, 902.257, 911.872, 921.624, 931.512, 941.53, 951.677, 961.948, 972.341, 982.851,
                      993.475, 1004.21, 1015.05, 1026, 1037.05, 1048.19, 1059.42, 1070.74, 1082.14, 1093.62, 1105.17,
                      1116.79, 1128.47, 1140.2, 1151.98, 1163.81, 1175.67, 1187.56, 1199.48, 1211.42, 1223.37, 1235.34,
                      1247.31, 1259.3, 1271.29, 1283.29, 1295.28, 1307.27, 1319.25, 1331.22, 1343.18, 1355.13, 1367.06,
                      1378.96, 1390.84, 1461.46, 1473.1, 1484.69, 1496.24, 1507.75, 1519.22, 1530.64, 1542.02, 1553.36,
                      1564.65, 1575.9, 1587.1, 1598.26, 1609.36, 1620.43, 1631.44, 1642.41, 1653.33, 1664.2, 1675.03,
                      1685.8, 1696.53, 1707.2, 1717.83, 1728.4, 1738.93, 1749.4, 1759.83, 1939.44, 1948.98, 1958.49,
                      1967.95, 1977.37, 1986.74, 1996.07, 2005.36, 2014.61, 2023.82, 2032.99, 2042.11, 2051.19, 2060.24,
                      2069.24, 2078.21, 2087.13, 2096.01, 2104.86, 2113.67, 2122.44, 2131.17, 2139.87, 2148.52, 2157.15,
                      2165.73, 2174.28, 2182.79, 2191.27, 2199.71, 2208.12, 2216.5, 2224.84, 2233.14, 2241.42, 2249.66,
                      2257.86, 2266.04, 2274.18, 2282.29, 2290.37, 2298.42, 2306.44, 2314.42, 2322.37, 2330.29, 2338.19,
                      2346.05, 2353.88, 2361.68, 2369.45, 2377.19, 2384.9, 2392.58, 2400.23, 2407.85, 2415.45, 2423.01,
                      2430.55, 2438.05, 2445.53}

        for w, f in zip(wavelength, fwhm):
            responses[w] = f
        return responses
