from enmapboxprocessing.algorithm.spectralresamplingbyresponsefunctionconvolutionalgorithmbase import \
    SpectralResamplingByResponseFunctionConvolutionAlgorithmBase
from typeguard import typechecked


@typechecked
class SpectralResamplingToSentinel2Algorithm(SpectralResamplingByResponseFunctionConvolutionAlgorithmBase):
    A_CODE = True

    def displayName(self) -> str:
        return 'Spectral resampling (to Sentinel-2 MSI)'

    def shortDescription(self) -> str:
        link = self.htmlLink(
            'https://sentinel.esa.int/web/sentinel/missions/sentinel-2',
            'Sentinel-2')
        return super().shortDescription() + f'\nFor more information see the {link} missions website.'

    def code(self):
        from collections import OrderedDict

        responses = OrderedDict()
        # responses['B1 - Coastal aerosol'] = [(412, 0.002), (413, 0.004), (414, 0.004), (415, 0.004), (416, 0.006), (417, 0.004), (418, 0.003), (419, 0.001), (420, 0.002), (421, 0.001), (422, 0.001), (423, 0.0), (424, 0.0), (425, 0.001), (426, 0.001), (427, 0.002), (428, 0.002), (429, 0.004), (430, 0.029), (431, 0.119), (432, 0.324), (433, 0.573), (434, 0.715), (435, 0.762), (436, 0.789), (437, 0.809), (438, 0.811), (439, 0.824), (440, 0.854), (441, 0.871), (442, 0.887), (443, 0.926), (444, 0.982), (445, 1.0), (446, 0.975), (447, 0.936), (448, 0.89), (449, 0.85), (450, 0.826), (451, 0.784), (452, 0.614), (453, 0.33), (454, 0.124), (455, 0.044), (456, 0.015)]
        responses['B2 - Blue'] = [(439, 0.01), (440, 0.03), (441, 0.027), (442, 0.024), (443, 0.02), (444, 0.023),
                                  (445, 0.025), (446, 0.017), (447, 0.021), (448, 0.016), (449, 0.021), (450, 0.018),
                                  (451, 0.018), (452, 0.018), (453, 0.019), (454, 0.019), (455, 0.027), (456, 0.043),
                                  (457, 0.072), (458, 0.154), (459, 0.328), (460, 0.553), (461, 0.71), (462, 0.753),
                                  (463, 0.752), (464, 0.757), (465, 0.763), (466, 0.762), (467, 0.785), (468, 0.815),
                                  (469, 0.862), (470, 0.893), (471, 0.92), (472, 0.919), (473, 0.913), (474, 0.9),
                                  (475, 0.89), (476, 0.882), (477, 0.876), (478, 0.884), (479, 0.907), (480, 0.932),
                                  (481, 0.939), (482, 0.944), (483, 0.922), (484, 0.886), (485, 0.847), (486, 0.813),
                                  (487, 0.782), (488, 0.773), (489, 0.772), (490, 0.787), (491, 0.812), (492, 0.846),
                                  (493, 0.888), (494, 0.928), (495, 0.951), (496, 0.966), (497, 0.969), (498, 0.966),
                                  (499, 0.958), (500, 0.954), (501, 0.952), (502, 0.957), (503, 0.966), (504, 0.977),
                                  (505, 0.977), (506, 0.974), (507, 0.959), (508, 0.935), (509, 0.902), (510, 0.872),
                                  (511, 0.844), (512, 0.823), (513, 0.815), (514, 0.821), (515, 0.84), (516, 0.87),
                                  (517, 0.915), (518, 0.961), (519, 0.992), (520, 1.0), (521, 0.984), (522, 0.911),
                                  (523, 0.74), (524, 0.504), (525, 0.305), (526, 0.18), (527, 0.107), (528, 0.066),
                                  (529, 0.042), (530, 0.027), (531, 0.014), (532, 0.003)]
        responses['B3 - Green'] = [(538, 0.014), (539, 0.034), (540, 0.073), (541, 0.154), (542, 0.317), (543, 0.553),
                                   (544, 0.749), (545, 0.849), (546, 0.898), (547, 0.922), (548, 0.926), (549, 0.911),
                                   (550, 0.888), (551, 0.865), (552, 0.847), (553, 0.839), (554, 0.845), (555, 0.862),
                                   (556, 0.888), (557, 0.924), (558, 0.96), (559, 0.987), (560, 1.0), (561, 0.999),
                                   (562, 0.981), (563, 0.945), (564, 0.898), (565, 0.856), (566, 0.818), (567, 0.789),
                                   (568, 0.765), (569, 0.75), (570, 0.751), (571, 0.761), (572, 0.782), (573, 0.799),
                                   (574, 0.81), (575, 0.814), (576, 0.774), (577, 0.629), (578, 0.404), (579, 0.215),
                                   (580, 0.107), (581, 0.048), (582, 0.018), (583, 0.001)]
        responses['B4 - Red'] = [(646, 0.001), (647, 0.026), (648, 0.117), (649, 0.391), (650, 0.75), (651, 0.945),
                                 (652, 0.98), (653, 0.994), (654, 1.0), (655, 0.995), (656, 0.991), (657, 0.977),
                                 (658, 0.941), (659, 0.879), (660, 0.816), (661, 0.773), (662, 0.754), (663, 0.76),
                                 (664, 0.783), (665, 0.81), (666, 0.836), (667, 0.861), (668, 0.886), (669, 0.911),
                                 (670, 0.934), (671, 0.95), (672, 0.959), (673, 0.96), (674, 0.959), (675, 0.958),
                                 (676, 0.955), (677, 0.944), (678, 0.895), (679, 0.744), (680, 0.477), (681, 0.23),
                                 (682, 0.08), (683, 0.026), (684, 0.004)]
        responses['B5 - Red edge 1'] = [(695, 0.028), (696, 0.124), (697, 0.394), (698, 0.761), (699, 0.971),
                                        (700, 0.999), (701, 1.0), (702, 0.994), (703, 0.983), (704, 0.967),
                                        (705, 0.948), (706, 0.927), (707, 0.904), (708, 0.886), (709, 0.867),
                                        (710, 0.791), (711, 0.588), (712, 0.263), (713, 0.057), (714, 0.006)]
        responses['B6 - Red edge 2'] = [(731, 0.002), (732, 0.055), (733, 0.258), (734, 0.647), (735, 0.892),
                                        (736, 0.902), (737, 0.915), (738, 0.941), (739, 0.963), (740, 0.975),
                                        (741, 0.977), (742, 0.987), (743, 1.0), (744, 0.989), (745, 0.972),
                                        (746, 0.901), (747, 0.607), (748, 0.205), (749, 0.027)]
        responses['B7 - Red edge 3'] = [(770, 0.012), (771, 0.052), (772, 0.166), (773, 0.369), (774, 0.637),
                                        (775, 0.861), (776, 0.97), (777, 0.991), (778, 0.999), (779, 1.0), (780, 0.977),
                                        (781, 0.926), (782, 0.866), (783, 0.82), (784, 0.794), (785, 0.791),
                                        (786, 0.804), (787, 0.819), (788, 0.826), (789, 0.82), (790, 0.792),
                                        (791, 0.721), (792, 0.588), (793, 0.414), (794, 0.231), (795, 0.099),
                                        (796, 0.027), (797, 0.005)]
        responses['B8 - NIR'] = [(774, 0.007), (775, 0.018), (776, 0.032), (777, 0.053), (778, 0.083), (779, 0.127),
                                 (780, 0.196), (781, 0.302), (782, 0.436), (783, 0.571), (784, 0.698), (785, 0.803),
                                 (786, 0.891), (787, 0.953), (788, 0.989), (789, 1.0), (790, 0.988), (791, 0.964),
                                 (792, 0.942), (793, 0.937), (794, 0.942), (795, 0.954), (796, 0.968), (797, 0.98),
                                 (798, 0.985), (799, 0.986), (800, 0.984), (801, 0.978), (802, 0.977), (803, 0.978),
                                 (804, 0.981), (805, 0.988), (806, 0.989), (807, 0.986), (808, 0.981), (809, 0.971),
                                 (810, 0.957), (811, 0.939), (812, 0.917), (813, 0.896), (814, 0.873), (815, 0.852),
                                 (816, 0.825), (817, 0.801), (818, 0.782), (819, 0.764), (820, 0.75), (821, 0.739),
                                 (822, 0.731), (823, 0.723), (824, 0.725), (825, 0.726), (826, 0.723), (827, 0.722),
                                 (828, 0.716), (829, 0.712), (830, 0.708), (831, 0.702), (832, 0.699), (833, 0.701),
                                 (834, 0.707), (835, 0.718), (836, 0.731), (837, 0.748), (838, 0.768), (839, 0.784),
                                 (840, 0.797), (841, 0.803), (842, 0.805), (843, 0.802), (844, 0.797), (845, 0.789),
                                 (846, 0.777), (847, 0.765), (848, 0.751), (849, 0.737), (850, 0.723), (851, 0.704),
                                 (852, 0.684), (853, 0.665), (854, 0.647), (855, 0.63), (856, 0.616), (857, 0.602),
                                 (858, 0.59), (859, 0.58), (860, 0.571), (861, 0.561), (862, 0.552), (863, 0.546),
                                 (864, 0.54), (865, 0.535), (866, 0.531), (867, 0.53), (868, 0.53), (869, 0.53),
                                 (870, 0.532), (871, 0.533), (872, 0.532), (873, 0.533), (874, 0.532), (875, 0.531),
                                 (876, 0.53), (877, 0.53), (878, 0.533), (879, 0.537), (880, 0.542), (881, 0.549),
                                 (882, 0.555), (883, 0.56), (884, 0.558), (885, 0.548), (886, 0.531), (887, 0.508),
                                 (888, 0.478), (889, 0.451), (890, 0.428), (891, 0.411), (892, 0.4), (893, 0.401),
                                 (894, 0.408), (895, 0.421), (896, 0.43), (897, 0.425), (898, 0.391), (899, 0.33),
                                 (900, 0.257), (901, 0.182), (902, 0.117), (903, 0.07), (904, 0.043), (905, 0.026),
                                 (906, 0.016), (907, 0.004)]
        responses['B8A - Narrow NIR'] = [(847, 0.002), (848, 0.002), (849, 0.013), (850, 0.026), (851, 0.053),
                                         (852, 0.108), (853, 0.222), (854, 0.397), (855, 0.61), (856, 0.817),
                                         (857, 0.932), (858, 0.972), (859, 0.975), (860, 0.975), (861, 0.973),
                                         (862, 0.976), (863, 0.98), (864, 0.987), (865, 0.991), (866, 0.997),
                                         (867, 1.0), (868, 0.999), (869, 0.996), (870, 0.995), (871, 1.0), (872, 0.996),
                                         (873, 0.924), (874, 0.741), (875, 0.49), (876, 0.25), (877, 0.112),
                                         (878, 0.048), (879, 0.023), (880, 0.011), (881, 0.001)]
        # responses['B9 - Water vapour'] = [(932, 0.017), (933, 0.061), (934, 0.174), (935, 0.389), (936, 0.665), (937, 0.875), (938, 0.937), (939, 0.968), (940, 0.989), (941, 0.995), (942, 1.0), (943, 0.978), (944, 0.981), (945, 0.992), (946, 0.988), (947, 0.994), (948, 0.983), (949, 0.978), (950, 0.95), (951, 0.953), (952, 0.922), (953, 0.856), (954, 0.71), (955, 0.464), (956, 0.215), (957, 0.065), (958, 0.016)]
        # responses['B10 - Cirrus'] = [(1350, 0.001), (1351, 0.002), (1352, 0.004), (1353, 0.008), (1354, 0.019), (1355, 0.045), (1356, 0.102), (1357, 0.201), (1358, 0.342), (1359, 0.506), (1360, 0.662), (1361, 0.783), (1362, 0.861), (1363, 0.91), (1364, 0.942), (1365, 0.962), (1366, 0.974), (1367, 0.982), (1368, 0.988), (1369, 0.993), (1370, 0.996), (1371, 0.999), (1372, 1.0), (1373, 0.999), (1374, 0.996), (1375, 0.991), (1376, 0.985), (1377, 0.978), (1378, 0.97), (1379, 0.961), (1380, 0.949), (1381, 0.933), (1382, 0.915), (1383, 0.894), (1384, 0.869), (1385, 0.831), (1386, 0.765), (1387, 0.655), (1388, 0.508), (1389, 0.351), (1390, 0.219), (1391, 0.127), (1392, 0.068), (1393, 0.033), (1394, 0.014), (1395, 0.005), (1396, 0.002), (1397, 0.001)]
        responses['B11 - SWIR-1'] = [(1551, 0.001), (1552, 0.002), (1553, 0.002), (1554, 0.004), (1555, 0.005),
                                     (1556, 0.008), (1557, 0.013), (1558, 0.019), (1559, 0.028), (1560, 0.04),
                                     (1561, 0.055), (1562, 0.075), (1563, 0.101), (1564, 0.135), (1565, 0.183),
                                     (1566, 0.247), (1567, 0.331), (1568, 0.43), (1569, 0.538), (1570, 0.647),
                                     (1571, 0.744), (1572, 0.815), (1573, 0.859), (1574, 0.88), (1575, 0.887),
                                     (1576, 0.889), (1577, 0.891), (1578, 0.898), (1579, 0.907), (1580, 0.917),
                                     (1581, 0.927), (1582, 0.935), (1583, 0.942), (1584, 0.948), (1585, 0.951),
                                     (1586, 0.954), (1587, 0.956), (1588, 0.958), (1589, 0.961), (1590, 0.963),
                                     (1591, 0.966), (1592, 0.968), (1593, 0.971), (1594, 0.973), (1595, 0.976),
                                     (1596, 0.979), (1597, 0.98), (1598, 0.981), (1599, 0.981), (1600, 0.981),
                                     (1601, 0.981), (1602, 0.981), (1603, 0.98), (1604, 0.981), (1605, 0.983),
                                     (1606, 0.985), (1607, 0.988), (1608, 0.99), (1609, 0.992), (1610, 0.993),
                                     (1611, 0.993), (1612, 0.99), (1613, 0.987), (1614, 0.984), (1615, 0.98),
                                     (1616, 0.976), (1617, 0.973), (1618, 0.97), (1619, 0.968), (1620, 0.966),
                                     (1621, 0.966), (1622, 0.966), (1623, 0.967), (1624, 0.97), (1625, 0.973),
                                     (1626, 0.979), (1627, 0.983), (1628, 0.988), (1629, 0.992), (1630, 0.995),
                                     (1631, 0.998), (1632, 0.999), (1633, 0.999), (1634, 0.999), (1635, 0.999),
                                     (1636, 0.999), (1637, 1.0), (1638, 1.0), (1639, 1.0), (1640, 1.0), (1641, 0.997),
                                     (1642, 0.992), (1643, 0.986), (1644, 0.979), (1645, 0.97), (1646, 0.961),
                                     (1647, 0.953), (1648, 0.947), (1649, 0.942), (1650, 0.939), (1651, 0.935),
                                     (1652, 0.928), (1653, 0.912), (1654, 0.881), (1655, 0.825), (1656, 0.743),
                                     (1657, 0.642), (1658, 0.534), (1659, 0.427), (1660, 0.324), (1661, 0.234),
                                     (1662, 0.164), (1663, 0.11), (1664, 0.072), (1665, 0.046), (1666, 0.029),
                                     (1667, 0.019), (1668, 0.013), (1669, 0.009), (1670, 0.007), (1671, 0.005),
                                     (1672, 0.003), (1673, 0.002), (1674, 0.002), (1675, 0.001), (1676, 0.001)]
        responses['B12 - SWIR-2'] = [(2079, 0.001), (2080, 0.003), (2081, 0.004), (2082, 0.007), (2083, 0.008),
                                     (2084, 0.008), (2085, 0.009), (2086, 0.009), (2087, 0.01), (2088, 0.011),
                                     (2089, 0.012), (2090, 0.013), (2091, 0.015), (2092, 0.017), (2093, 0.02),
                                     (2094, 0.023), (2095, 0.028), (2096, 0.033), (2097, 0.04), (2098, 0.049),
                                     (2099, 0.06), (2100, 0.073), (2101, 0.091), (2102, 0.111), (2103, 0.137),
                                     (2104, 0.168), (2105, 0.203), (2106, 0.243), (2107, 0.285), (2108, 0.327),
                                     (2109, 0.368), (2110, 0.408), (2111, 0.445), (2112, 0.477), (2113, 0.503),
                                     (2114, 0.525), (2115, 0.543), (2116, 0.557), (2117, 0.569), (2118, 0.579),
                                     (2119, 0.589), (2120, 0.599), (2121, 0.61), (2122, 0.621), (2123, 0.634),
                                     (2124, 0.649), (2125, 0.664), (2126, 0.68), (2127, 0.696), (2128, 0.712),
                                     (2129, 0.727), (2130, 0.741), (2131, 0.757), (2132, 0.772), (2133, 0.786),
                                     (2134, 0.798), (2135, 0.81), (2136, 0.82), (2137, 0.829), (2138, 0.837),
                                     (2139, 0.844), (2140, 0.851), (2141, 0.853), (2142, 0.855), (2143, 0.856),
                                     (2144, 0.858), (2145, 0.86), (2146, 0.861), (2147, 0.863), (2148, 0.865),
                                     (2149, 0.867), (2150, 0.87), (2151, 0.874), (2152, 0.879), (2153, 0.882),
                                     (2154, 0.886), (2155, 0.889), (2156, 0.893), (2157, 0.897), (2158, 0.9),
                                     (2159, 0.903), (2160, 0.905), (2161, 0.906), (2162, 0.906), (2163, 0.906),
                                     (2164, 0.905), (2165, 0.905), (2166, 0.904), (2167, 0.903), (2168, 0.903),
                                     (2169, 0.902), (2170, 0.902), (2171, 0.903), (2172, 0.904), (2173, 0.905),
                                     (2174, 0.906), (2175, 0.908), (2176, 0.91), (2177, 0.913), (2178, 0.916),
                                     (2179, 0.918), (2180, 0.921), (2181, 0.924), (2182, 0.927), (2183, 0.93),
                                     (2184, 0.932), (2185, 0.934), (2186, 0.936), (2187, 0.937), (2188, 0.938),
                                     (2189, 0.938), (2190, 0.938), (2191, 0.94), (2192, 0.943), (2193, 0.943),
                                     (2194, 0.943), (2195, 0.942), (2196, 0.941), (2197, 0.938), (2198, 0.937),
                                     (2199, 0.935), (2200, 0.933), (2201, 0.927), (2202, 0.921), (2203, 0.915),
                                     (2204, 0.911), (2205, 0.908), (2206, 0.907), (2207, 0.908), (2208, 0.911),
                                     (2209, 0.916), (2210, 0.923), (2211, 0.921), (2212, 0.919), (2213, 0.919),
                                     (2214, 0.921), (2215, 0.925), (2216, 0.928), (2217, 0.932), (2218, 0.937),
                                     (2219, 0.941), (2220, 0.947), (2221, 0.951), (2222, 0.954), (2223, 0.957),
                                     (2224, 0.96), (2225, 0.963), (2226, 0.965), (2227, 0.966), (2228, 0.967),
                                     (2229, 0.966), (2230, 0.965), (2231, 0.965), (2232, 0.964), (2233, 0.962),
                                     (2234, 0.959), (2235, 0.957), (2236, 0.955), (2237, 0.954), (2238, 0.953),
                                     (2239, 0.952), (2240, 0.952), (2241, 0.952), (2242, 0.953), (2243, 0.954),
                                     (2244, 0.957), (2245, 0.961), (2246, 0.964), (2247, 0.968), (2248, 0.973),
                                     (2249, 0.977), (2250, 0.983), (2251, 0.987), (2252, 0.991), (2253, 0.994),
                                     (2254, 0.997), (2255, 0.999), (2256, 1.0), (2257, 1.0), (2258, 0.999),
                                     (2259, 0.997), (2260, 0.994), (2261, 0.99), (2262, 0.984), (2263, 0.976),
                                     (2264, 0.968), (2265, 0.958), (2266, 0.948), (2267, 0.938), (2268, 0.928),
                                     (2269, 0.917), (2270, 0.906), (2271, 0.894), (2272, 0.882), (2273, 0.869),
                                     (2274, 0.855), (2275, 0.841), (2276, 0.826), (2277, 0.81), (2278, 0.792),
                                     (2279, 0.772), (2280, 0.749), (2281, 0.72), (2282, 0.688), (2283, 0.651),
                                     (2284, 0.61), (2285, 0.566), (2286, 0.521), (2287, 0.475), (2288, 0.429),
                                     (2289, 0.386), (2290, 0.342), (2291, 0.301), (2292, 0.263), (2293, 0.228),
                                     (2294, 0.196), (2295, 0.168), (2296, 0.145), (2297, 0.125), (2298, 0.108),
                                     (2299, 0.094), (2300, 0.082), (2301, 0.072), (2302, 0.063), (2303, 0.055),
                                     (2304, 0.048), (2305, 0.043), (2306, 0.039), (2307, 0.035), (2308, 0.032),
                                     (2309, 0.03), (2310, 0.027), (2311, 0.026), (2312, 0.024), (2313, 0.022),
                                     (2314, 0.019), (2315, 0.016), (2316, 0.011), (2317, 0.007), (2318, 0.007),
                                     (2319, 0.005), (2320, 0.002)]

        return responses
